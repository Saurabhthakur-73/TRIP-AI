const {
    GoogleGenerativeAI,
    HarmCategory,
    HarmBlockThreshold,
  } = require("@google/generative-ai");
  const fs = require("node:fs");
  const mime = require("mime-types");
  
  const apiKey = import.meta.env.VITE_GEMINI_API_KEY;
  const genAI = new GoogleGenerativeAI(apiKey);
  
  const model = genAI.getGenerativeModel({
    model: "gemini-2.5-pro-preview-03-25",
  });
  
  const generationConfig = {
    temperature: 1,
    topP: 0.95,
    topK: 64,
    maxOutputTokens: 65536,
    responseModalities: [
    ],
    responseMimeType: "application/json",
  };
  
  
    export const chatSession = model.startChat({
      generationConfig,
      history: [
        {
          role: "user",
          parts: [
            {text: "Generate Travel Plan for Location : Las Vegas, for 3 Days for Couple with a Cheap budget. Give me a Hotels options list with HotelName, Hotel address, Price, hotel image url, geo coordinates, rating, descriptions and suggest itinerary with placeName, Place Details, Place Image Url, Geo Coordinates, ticket Pricing, rating, Time travel each of the location for 3 days with each day plan with best time to visit in JSON format."},
          ],
        },
        {
          role: "model",
          parts: [
            {text: "Here's a breakdown of the thought process to generate the Las Vegas travel plan:\n\n1.  **Deconstruct the Request:**\n\n    *   **Location:** Las Vegas, Nevada, USA.\n    *   **Duration:** 3 Days.\n    *   **Travelers:** Couple.\n    *   **Budget:** Cheap/Budget-friendly.\n    *   **Deliverables:**\n        *   Hotel Options List (JSON format):\n            *   HotelName\n            *   Hotel address\n            *   Price (Indication, like \"$\", \"$$\", etc., or a general range like \"Budget-friendly\")\n            *   Hotel image URL\n            *   Geo coordinates (Latitude, Longitude)\n            *   Rating (e.g., 3-star, user rating)\n            *   Descriptions\n        *   3-Day Itinerary (JSON format):\n            *   Organized by Day (Day 1, Day 2, Day 3).\n            *   For each day, a list of activities/places.\n            *   For each place/activity:\n                *   placeName\n                *   Place Details (Description)\n                *   Place Image Url\n                *   Geo Coordinates (Latitude, Longitude)\n                *   Ticket Pricing (Indication, e.g., \"Free\", \"Low\", \"$\", \"$$\")\n                *   Rating (User rating or general appeal)\n                *   Time travel (Estimated time *at* the location, maybe travel *between* locations implicitly or explicitly mentioned)\n                *   Best time to visit (Specific time of day, if applicable)\n    *   **Format:** JSON.\n\n2.  **Identify Key Constraints & Considerations:**\n\n    *   **Budget:** This is the primary driver. Need to focus on free activities, affordable food options, cheaper hotels (likely off-Strip or older Strip properties), and cost-effective transportation (walking, bus, potentially monorail). Avoid expensive shows, high-end restaurants, and extensive gambling unless budgeted separately.\n    *   **Couple:** Activities should be suitable for two people. Romantic elements (like Bellagio Fountains, exploring themed hotels) can be included, but keep the budget in mind.\n    *   **Duration (3 Days):** Need a balanced itinerary that covers key Vegas experiences without being overly rushed or expensive. Mix Strip exploration, Downtown/Fremont Street, and maybe one unique, cheaper off-Strip activity.\n    *   **Las Vegas Specifics:** Vegas is about spectacle, walking the Strip, themed hotels, Fremont Street Experience, maybe some pool time (depending on the hotel/season), and affordable food courts/buffets (though buffets aren't as cheap as they used to be).\n\n3.  **Information Gathering (Simulated):**\n\n    *   **Budget Hotels:** Search for hotels known for being affordable in Vegas. This often includes Downtown hotels (Golden Nugget - maybe slightly higher budget, The D, Four Queens, El Cortez), older Strip hotels (Excalibur, Luxor, Flamingo, Harrah's, LINQ, Circus Circus - though maybe too family-oriented), and some slightly off-Strip properties (Tuscany Suites, Ellis Island). Need to find representative images, addresses, rough price indicators, ratings, coordinates, and brief descriptions. *Self-correction: Need realistic price indicators, maybe \"$\" symbols or \"Budget-friendly\" rather than specific numbers which fluctuate wildly.*\n    *   **Budget Activities:**\n        *   *Free:* Walking the Strip, Bellagio Fountains, Bellagio Conservatory, Mirage Volcano (check if still running - *Update: Volcano is gone/being removed, replace with something else*), Fremont Street Experience light show, exploring themed hotel interiors (Venetian, Bellagio, Caesars, Paris), Window shopping, \"Welcome to Fabulous Las Vegas\" sign photo op.\n        *   *Cheap:* Happy hour deals, affordable food courts, Downtown Container Park, potentially a cheaper show (matinee, discount tickets via Tix4Tonight - mention this), monorail pass (if covering long distances frequently), Deuce bus pass. Maybe Pinball Hall of Fame or Neon Museum (might stretch the \"cheap\" definition, need to check prices).\n    *   **Itinerary Structure:**\n        *   **Day 1:** Arrival, check-in, South/Mid-Strip exploration (Bellagio Fountains, Conservatory, maybe Paris/Planet Hollywood area). Focus on free sights. Evening: Bellagio Fountains again (night view), maybe explore CityCenter/Aria area. Dinner: Food court or budget eatery.\n        *   **Day 2:** North Strip/Downtown focus. Morning: Explore Venetian/Palazzo. Afternoon: Head Downtown (use Deuce bus or rideshare). Explore Fremont Street, maybe Container Park. Evening: Fremont Street Experience light show. Dinner: Cheaper Downtown options or happy hour.\n        *   **Day 3:** Unique activity/Wrap-up. Morning: \"Welcome to Fabulous Las Vegas\" sign (best early to avoid crowds/heat). Maybe Pinball Hall of Fame or a pool morning (if hotel allows/is decent). Afternoon: Last minute souvenir shopping, maybe explore a hotel missed earlier (e.g., Caesars Palace Forum Shops). Check-out/Departure.\n\n4.  **Data Acquisition (Simulated):**\n\n    *   Use search engines (like Google Maps, hotel booking sites, travel blogs) to find:\n        *   Hotel addresses, coordinates, sample images, typical ratings, descriptions.\n        *   Attraction addresses, coordinates, sample images, typical ratings, descriptions, *current* operating status (e.g., Mirage Volcano), ticket prices (or free status).\n        *   Estimate time needed at each location.\n        *   Find representative image URLs (use reliable sources like Wikimedia Commons, hotel sites, official tourism sites, or stock photo sites if necessary, ensuring they are generic enough). *Self-correction: Ensure image URLs are publicly accessible and likely stable.*\n        *   Determine \"Best Time to Visit\" (e.g., Fountains at night, Sign early morning, Fremont Street at night).\n\n5.  **JSON Structure Design:**\n\n    *   Create a main JSON object `{}`.\n    *   Inside, add two keys: `\"hotelOptions\"` (an array of hotel objects) and `\"itinerary\"` (an object with keys \"Day 1\", \"Day 2\", \"Day 3\", each containing an array of place/activity objects).\n    *   Define the structure for hotel objects based on the request (HotelName, Hotel address, Price, hotel image url, geo coordinates {lat, lon}, rating, descriptions).\n    *   Define the structure for itinerary place objects based on the request (placeName, Place Details, Place Image Url, Geo Coordinates {lat, lon}, ticket Pricing, rating, Time travel, Best time to visit).\n\n6.  **Populate the JSON:**\n\n    *   **Hotels:** Select 3-4 diverse budget options (e.g., one Downtown, one older Strip South, one older Strip Center/North). Fill in the details gathered in step 4. Use price indicators like \"$ - Budget\", \"$$ - Moderate Budget\".\n    *   **Itinerary - Day 1:** Add activities like checking in, walking South Strip, Bellagio Fountains, Bellagio Conservatory. Fill in details, coordinates, image URLs, pricing (mostly \"Free\"), estimated times, best times.\n    *   **Itinerary - Day 2:** Add activities like exploring Venetian, traveling to Downtown, Fremont Street Experience, Container Park. Fill in details. Note transportation cost (e.g., Deuce bus pass).\n    *   **Itinerary - Day 3:** Add activities like Vegas Sign, Pinball Hall of Fame (as a cheap option), maybe LINQ Promenade (free to walk). Fill in details.\n    *   **Refine Details:** Add practical tips within descriptions (wear comfy shoes, stay hydrated, look for happy hours, consider bus pass). Ensure coordinates are reasonably accurate. Select appropriate, representative image URLs. Double-check pricing indicators (\"Free\", \"Low\", \"$\", etc.). Add estimated duration *at* the place (\"Time travel\").\n\n7.  **Review and Validate:**\n\n    *   Read through the entire JSON structure. Does it match the requested format?\n    *   Is the content logical? Does the itinerary flow reasonably?\n    *   Is it truly budget-focused? Are the suggestions affordable?\n    *   Are all required fields present for hotels and itinerary items?\n    *   Are the image URLs working (spot check a few)?\n    *   Are the coordinates plausible?\n    *   Is the JSON syntax correct (commas, brackets, braces, quotes)? Use a JSON validator if unsure. *Self-correction: Ensure final output is enclosed in a single JSON block.*\n\nThis structured approach helps ensure all requirements are met, the budget constraint is respected, and the resulting JSON is well-formed and useful. The simulated information gathering reflects how one would research this data using online tools."},
            {text: "```json\n{\n  \"planTitle\": \"Las Vegas 3-Day Budget Itinerary for a Couple\",\n  \"location\": \"Las Vegas, Nevada, USA\",\n  \"duration\": \"3 Days\",\n  \"travelerType\": \"Couple\",\n  \"budgetLevel\": \"Cheap / Budget-Friendly\",\n  \"hotelOptions\": [\n    {\n      \"HotelName\": \"Excalibur Hotel & Casino\",\n      \"Hotel address\": \"3850 S Las Vegas Blvd, Las Vegas, NV 89109, USA\",\n      \"Price\": \"$ - Budget\",\n      \"hotel_image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/Excalibur_Hotel_Casino_Las_Vegas_2020.jpg/1280px-Excalibur_Hotel_Casino_Las_Vegas_2020.jpg\",\n      \"geo_coordinates\": {\n        \"latitude\": 36.1045,\n        \"longitude\": -115.1745\n      },\n      \"rating\": \"3.5 Stars\",\n      \"descriptions\": \"Iconic castle-themed hotel on the South Strip. Offers basic but functional rooms, a large casino floor, food court, and budget-friendly entertainment options. Connected by walkways/trams to Luxor and Mandalay Bay.\"\n    },\n    {\n      \"HotelName\": \"Flamingo Las Vegas Hotel & Casino\",\n      \"Hotel address\": \"3555 S Las Vegas Blvd, Las Vegas, NV 89109, USA\",\n      \"Price\": \"$$ - Moderate Budget\",\n      \"hotel_image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7a/Flamingo_Las_Vegas_Exterior_2022.jpg/1024px-Flamingo_Las_Vegas_Exterior_2022.jpg\",\n      \"geo_coordinates\": {\n        \"latitude\": 36.1163,\n        \"longitude\": -115.1712\n      },\n      \"rating\": \"3.5 Stars\",\n      \"descriptions\": \"Classic Vegas hotel with a prime center-Strip location. Features updated 'GO' rooms and older 'Flamingo' rooms (often cheaper). Known for its vibrant pool area (seasonal) and the free Wildlife Habitat.\"\n    },\n    {\n      \"HotelName\": \"The LINQ Hotel + Experience\",\n      \"Hotel address\": \"3535 S Las Vegas Blvd, Las Vegas, NV 89109, USA\",\n      \"Price\": \"$$ - Moderate Budget\",\n      \"hotel_image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/The_Linq_Hotel_%26_Casino_%28Las_Vegas%29.jpg/1024px-The_Linq_Hotel_%26_Casino_%28Las_Vegas%29.jpg\",\n      \"geo_coordinates\": {\n        \"latitude\": 36.1177,\n        \"longitude\": -115.1708\n      },\n      \"rating\": \"4 Stars\",\n      \"descriptions\": \"Modern hotel targeting a younger crowd, located center-Strip. Rooms are compact but stylish. Offers easy access to the LINQ Promenade, High Roller observation wheel, and numerous dining/drinking options.\"\n    },\n    {\n      \"HotelName\": \"Golden Nugget Las Vegas Hotel & Casino\",\n      \"Hotel address\": \"129 E Fremont St, Las Vegas, NV 89101, USA\",\n      \"Price\": \"$$ - Moderate Budget (Often cheaper than mid-Strip)\",\n      \"hotel_image_url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/a/ab/Golden_Nugget_Las_Vegas_hotel_tower.jpg/1024px-Golden_Nugget_Las_Vegas_hotel_tower.jpg\",\n      \"geo_coordinates\": {\n        \"latitude\": 36.1706,\n        \"longitude\": -115.1433\n      },\n      \"rating\": \"4 Stars\",\n      \"descriptions\": \"Upscale option in Downtown Las Vegas on the Fremont Street Experience. Features a famous pool complex ('The Tank') with a shark tank slide (pool access may have fees or be seasonal), multiple restaurants, and a lively casino.\"\n    }\n  ],\n  \"itinerary\": {\n    \"Day 1\": {\n      \"theme\": \"Arrival & South/Mid-Strip Exploration\",\n      \"plan\": [\n        {\n          \"placeName\": \"Check into Hotel\",\n          \"Place Details\": \"Arrive in Las Vegas, check into your chosen budget-friendly hotel. Drop off luggage and freshen up.\",\n          \"Place Image Url\": \"https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1740&q=80\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1146,\n            \"longitude\": -115.1728\n          },\n          \"ticket Pricing\": \"Hotel Cost\",\n          \"rating\": \"N/A\",\n          \"Time travel\": \"1-2 hours (including travel from airport/arrival)\",\n          \"Best time to visit\": \"Afternoon (standard check-in time)\"\n        },\n        {\n          \"placeName\": \"'Welcome to Fabulous Las Vegas' Sign\",\n          \"Place Details\": \"Take a bus (Deuce) or rideshare south to the iconic Welcome Sign for a classic photo op. It's free to visit, but expect a line for photos, especially mid-day.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/0/05/Welcome_to_Fabulous_Las_Vegas_sign.jpg/1280px-Welcome_to_Fabulous_Las_Vegas_sign.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.0820,\n            \"longitude\": -115.1728\n          },\n          \"ticket Pricing\": \"Free (transportation cost extra)\",\n          \"rating\": \"4.0 Stars\",\n          \"Time travel\": \"30-45 minutes (including wait time)\",\n          \"Best time to visit\": \"Early morning or late afternoon to avoid crowds and heat.\"\n        },\n        {\n          \"placeName\": \"Explore South Strip Hotels (Exterior & Free Areas)\",\n          \"Place Details\": \"Walk north from the sign (or take the bus back part way) and explore the exteriors and free public areas of Mandalay Bay, Luxor (unique pyramid shape), and Excalibur (castle theme). Budget-friendly food courts available inside.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Las_Vegas_Strip_Night_View_2018.jpg/1280px-Las_Vegas_Strip_Night_View_2018.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1026,\n            \"longitude\": -115.1745\n          },\n          \"ticket Pricing\": \"Free\",\n          \"rating\": \"4.0 Stars\",\n          \"Time travel\": \"1.5 - 2 hours\",\n          \"Best time to visit\": \"Late Afternoon / Early Evening\"\n        },\n        {\n          \"placeName\": \"Bellagio Conservatory & Botanical Gardens\",\n          \"Place Details\": \"Head to the Bellagio Hotel and visit the stunning Conservatory. The elaborate floral displays change seasonally and are completely free to view. A beautiful and romantic spot.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/Bellagio_Conservatory_%28Las_Vegas%29.jpg/1024px-Bellagio_Conservatory_%28Las_Vegas%29.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1126,\n            \"longitude\": -115.1740\n          },\n          \"ticket Pricing\": \"Free\",\n          \"rating\": \"4.8 Stars\",\n          \"Time travel\": \"30-45 minutes\",\n          \"Best time to visit\": \"Anytime, but less crowded on weekday mornings.\"\n        },\n        {\n          \"placeName\": \"Fountains of Bellagio Show\",\n          \"Place Details\": \"Witness the iconic water show synchronized to music and lights in the lake in front of the Bellagio. Shows run frequently in the afternoons and evenings.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Bellagio_Fountains_at_night.jpg/1280px-Bellagio_Fountains_at_night.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1124,\n            \"longitude\": -115.1738\n          },\n          \"ticket Pricing\": \"Free\",\n          \"rating\": \"4.7 Stars\",\n          \"Time travel\": \"15-30 minutes (per show)\",\n          \"Best time to visit\": \"Evening (shows are more frequent and visually striking with lights)\"\n        },\n        {\n          \"placeName\": \"Budget Dinner\",\n          \"Place Details\": \"Grab dinner at a budget-friendly spot. Options include hotel food courts (e.g., Excalibur, Planet Hollywood), Ocean One Bar & Grille (Planet Hollywood Miracle Mile Shops - known for lunch specials), or look for happy hour deals.\",\n          \"Place Image Url\": \"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=987&q=80\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1106,\n            \"longitude\": -115.1722\n          },\n          \"ticket Pricing\": \"$ - $$\",\n          \"rating\": \"Varies\",\n          \"Time travel\": \"1 hour\",\n          \"Best time to visit\": \"Evening\"\n        }\n      ]\n    },\n    \"Day 2\": {\n      \"theme\": \"Center Strip Wonders & Downtown Fremont Street\",\n      \"plan\": [\n        {\n          \"placeName\": \"Explore Venetian & Palazzo\",\n          \"Place Details\": \"Visit The Venetian and its sister property, The Palazzo. Wander through the Grand Canal Shoppes, admire the replica canals (gondola rides are pricey, but watching is free), St. Mark's Square, and the general Italian ambiance. Look for the free 'Streetmosphere' performers.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/7/76/Venetian_Las_Vegas_Gondolas_interior.jpg/1024px-Venetian_Las_Vegas_Gondolas_interior.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1244,\n            \"longitude\": -115.1717\n          },\n          \"ticket Pricing\": \"Free (unless shopping/dining)\",\n          \"rating\": \"4.6 Stars\",\n          \"Time travel\": \"1.5 - 2 hours\",\n          \"Best time to visit\": \"Late Morning / Early Afternoon\"\n        },\n        {\n          \"placeName\": \"Flamingo Wildlife Habitat\",\n          \"Place Details\": \"Take a peaceful break at the Flamingo Hotel's Wildlife Habitat. See flamingos, pelicans, ducks, koi fish, and turtles in a serene garden setting. A hidden gem and completely free.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/d/d9/Flamingo_Las_Vegas_Wildlife_Habitat_2019.jpg/1024px-Flamingo_Las_Vegas_Wildlife_Habitat_2019.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1169,\n            \"longitude\": -115.1706\n          },\n          \"ticket Pricing\": \"Free\",\n          \"rating\": \"4.4 Stars\",\n          \"Time travel\": \"30-45 minutes\",\n          \"Best time to visit\": \"Daytime (animals are more active)\"\n        },\n        {\n          \"placeName\": \"Travel to Downtown Las Vegas (Fremont Street)\",\n          \"Place Details\": \"Use the Deuce bus (purchase a day pass for cost-effectiveness) or a rideshare to head north to Downtown Las Vegas, the original heart of the city.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Deuce_on_the_Strip_bus_stop_sign_in_Las_Vegas.jpg/800px-Deuce_on_the_Strip_bus_stop_sign_in_Las_Vegas.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1700,\n            \"longitude\": -115.1440\n          },\n          \"ticket Pricing\": \"Bus Pass (~$8 for 24hr) or Rideshare Cost ($$)\",\n          \"rating\": \"N/A\",\n          \"Time travel\": \"30-45 minutes (depending on traffic)\",\n          \"Best time to visit\": \"Mid-Late Afternoon\"\n        },\n        {\n          \"placeName\": \"Explore Fremont Street (Daytime)\",\n          \"Place Details\": \"Walk around Old Vegas. See the classic casinos, check out street performers (tip if you watch), and soak in the different vibe compared to the Strip. Look for cheaper souvenir shops.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/b/bc/Fremont_Street_Experience%2C_Las_Vegas.jpg/1280px-Fremont_Street_Experience%2C_Las_Vegas.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1703,\n            \"longitude\": -115.1441\n          },\n          \"ticket Pricing\": \"Free\",\n          \"rating\": \"4.5 Stars\",\n          \"Time travel\": \"1 - 1.5 hours\",\n          \"Best time to visit\": \"Late Afternoon\"\n        },\n        {\n          \"placeName\": \"Downtown Container Park\",\n          \"Place Details\": \"Visit this unique open-air shopping center and park made from shipping containers. Features boutique shops, quirky eateries, a playground (for kids), and often free entertainment. Check out the giant praying mantis sculpture out front (it shoots fire at night!).\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/f/f1/Downtown_Container_Park_Entrance_with_Mantis.jpg/1024px-Downtown_Container_Park_Entrance_with_Mantis.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1672,\n            \"longitude\": -115.1378\n          },\n          \"ticket Pricing\": \"Free to enter (shopping/dining extra)\",\n          \"rating\": \"4.3 Stars\",\n          \"Time travel\": \"1 hour\",\n          \"Best time to visit\": \"Late Afternoon / Early Evening\"\n        },\n        {\n          \"placeName\": \"Budget Dinner Downtown\",\n          \"Place Details\": \"Downtown offers many classic and cheaper food options. Consider Heart Attack Grill (for the spectacle, maybe share!), cheap prime rib specials (check local listings/casino cafes), or Evel Pie pizza.\",\n          \"Place Image Url\": \"https://images.unsplash.com/photo-1621870720763-d9c413ff3973?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1740&q=80\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1699,\n            \"longitude\": -115.1441\n          },\n          \"ticket Pricing\": \"$ - $$\",\n          \"rating\": \"Varies\",\n          \"Time travel\": \"1 hour\",\n          \"Best time to visit\": \"Evening\"\n        },\n        {\n          \"placeName\": \"Fremont Street Experience Light Show (Viva Vision)\",\n          \"Place Details\": \"Experience the main attraction of Downtown: the massive LED canopy light show synchronized to music. Shows typically run every hour in the evening.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Fremont_Street_Experience_-_Viva_Vision_-_Las_Vegas.jpg/1280px-Fremont_Street_Experience_-_Viva_Vision_-_Las_Vegas.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1703,\n            \"longitude\": -115.1441\n          },\n          \"ticket Pricing\": \"Free\",\n          \"rating\": \"4.6 Stars\",\n          \"Time travel\": \"30 minutes (per show)\",\n          \"Best time to visit\": \"Evening (hourly, check schedule)\"\n        }\n      ]\n    },\n    \"Day 3\": {\n      \"theme\": \"Unique Vegas & Departure Prep\",\n      \"plan\": [\n        {\n          \"placeName\": \"Pinball Hall of Fame\",\n          \"Place Details\": \"A fun, nostalgic, and relatively cheap activity. Pay only for the games you play (most are 25-75 cents). Features hundreds of pinball machines from different eras. Located south on the Strip.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/8/84/Pinball_Hall_of_Fame_Las_Vegas_2021.jpg/1280px-Pinball_Hall_of_Fame_Las_Vegas_2021.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.0991,\n            \"longitude\": -115.1704\n          },\n          \"ticket Pricing\": \"Free Entry (Pay per game, $-$$)\",\n          \"rating\": \"4.7 Stars\",\n          \"Time travel\": \"1.5 - 2 hours\",\n          \"Best time to visit\": \"Opens late morning, good anytime.\"\n        },\n        {\n          \"placeName\": \"Explore LINQ Promenade\",\n          \"Place Details\": \"Walk through the open-air LINQ Promenade located center-Strip. Lots of shops (window shopping!), restaurants, bars, and access to the High Roller observation wheel (ride is pricey, but promenade is free). Good spot for people-watching.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/f/f7/LINQ_Promenade_Las_Vegas_2020.jpg/1280px-LINQ_Promenade_Las_Vegas_2020.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1177,\n            \"longitude\": -115.1700\n          },\n          \"ticket Pricing\": \"Free (unless buying things or riding High Roller)\",\n          \"rating\": \"4.4 Stars\",\n          \"Time travel\": \"1 - 1.5 hours\",\n          \"Best time to visit\": \"Afternoon / Evening\"\n        },\n        {\n          \"placeName\": \"Budget Lunch / Happy Hour\",\n          \"Place Details\": \"Find a final cheap lunch or take advantage of afternoon happy hour deals for drinks and appetizers before heading out. Many bars/restaurants on the Strip and side streets offer deals.\",\n          \"Place Image Url\": \"https://images.unsplash.com/photo-1568901346375-23c9450c58cd?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1299&q=80\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1146,\n            \"longitude\": -115.1728\n          },\n          \"ticket Pricing\": \"$ - $$\",\n          \"rating\": \"Varies\",\n          \"Time travel\": \"1 hour\",\n          \"Best time to visit\": \"Lunchtime or mid-afternoon for Happy Hour\"\n        },\n        {\n          \"placeName\": \"Last Minute Souvenirs / Hotel Check-out\",\n          \"Place Details\": \"Grab any last-minute cheap souvenirs from stores like Bonanza Gift Shop (world's largest) or ABC Stores/Walgreens/CVS on the Strip. Head back to the hotel to collect luggage and check out.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Bonanza_Gift_Shop_Las_Vegas.JPG/1024px-Bonanza_Gift_Shop_Las_Vegas.JPG\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.1325,\n            \"longitude\": -115.1640\n          },\n          \"ticket Pricing\": \"Shopping Cost\",\n          \"rating\": \"4.0 Stars (Bonanza)\",\n          \"Time travel\": \"1-2 hours (including travel and check-out)\",\n          \"Best time to visit\": \"Afternoon\"\n        },\n        {\n          \"placeName\": \"Departure\",\n          \"Place Details\": \"Head to the airport (Harry Reid International Airport - LAS) via bus, shuttle, or rideshare.\",\n          \"Place Image Url\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a1/Harry_Reid_International_Airport_Terminal_3_exterior.jpg/1280px-Harry_Reid_International_Airport_Terminal_3_exterior.jpg\",\n          \"Geo Coordinates\": {\n            \"latitude\": 36.0840,\n            \"longitude\": -115.1537\n          },\n          \"ticket Pricing\": \"Transportation Cost\",\n          \"rating\": \"N/A\",\n          \"Time travel\": \"1 hour (including travel time)\",\n          \"Best time to visit\": \"Allow ample time before flight\"\n        }\n      ]\n    }\n  },\n  \"budgetTips\": [\n    \"Walk as much as possible, wear comfortable shoes!\",\n    \"Utilize the Deuce bus for longer distances on the Strip and to Downtown (buy a multi-day pass).\",\n    \"Look for hotel food courts and budget eateries (e.g., Ocean One lunch special, In-N-Out Burger, White Castle).\",\n    \"Take advantage of Happy Hour deals for cheaper drinks and appetizers.\",\n    \"Carry a reusable water bottle and refill it to save money and stay hydrated.\",\n    \"Set a strict gambling budget if you plan to play, or avoid it altogether.\",\n    \"Enjoy the many free attractions: Bellagio Fountains/Conservatory, Fremont Street Experience, hotel wandering, Wildlife Habitat.\",\n    \"Consider buying snacks and drinks at CVS/Walgreens instead of hotel shops.\",\n    \"Check Tix4Tonight booths for potential discounts on shows or attractions if your budget allows a small splurge.\"\n  ]\n}\n```"},
          ],
        },
      ],
    });
  
   
    // TODO: Following code needs to be updated for client-side apps.
    const candidates = result.response.candidates;
    for(let candidate_index = 0; candidate_index < candidates.length; candidate_index++) {
      for(let part_index = 0; part_index < candidates[candidate_index].content.parts.length; part_index++) {
        const part = candidates[candidate_index].content.parts[part_index];
        if(part.inlineData) {
          try {
            const filename = `output_${candidate_index}_${part_index}.${mime.extension(part.inlineData.mimeType)}`;
            fs.writeFileSync(filename, Buffer.from(part.inlineData.data, 'base64'));
            console.log(`Output written to: ${filename}`);
          } catch (err) {
            console.error(err);
          }
        }
      }
    }